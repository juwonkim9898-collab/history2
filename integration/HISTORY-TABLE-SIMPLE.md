# 히스토리 페이지 - 테이블 구조 (간단 버전)

## 📖 히스토리 페이지는 이 데이터만 조회합니다

---

## 📊 records (기록 테이블)

히스토리 페이지에서 조회하는 메인 데이터

```
┌──────────────┬──────────────┬─────────────────────────────────┐
│   컬럼명      │    타입       │          설명                    │
├──────────────┼──────────────┼─────────────────────────────────┤
│ id           │ bigINT       │ 기록 번호                        │
  userid        VARCHAR(255)    │
│ content      │ TEXT         │ 기록 내용 (본문)                 │
│ record_date  │ DATE         │ 기록 날짜 (예: 2025-12-29)       │
│
│ tags         │ TEXT[]       │ 태그 (예: ["개발", "학습"])      │
│                        │
└──────────────┴──────────────┴─────────────────────────────────┘
```

### 예시 데이터
```json
{
  "id": 1,
  "title": "프로젝트 시작",
  "content": "오늘부터 새로운 프로젝트를 시작했다...",
  "recordDate": "2025-12-01",
  "category": "학습",
  "tags": ["프로젝트", "개발", "시작"],
  "createdAt": "2025-12-01T10:00:00Z"
}
```

---

## 📎 record_attachments (첨부파일 테이블)

기록에 첨부된 파일 정보

```
┌──────────────┬──────────────┬─────────────────────────────────┐
│   컬럼명      │    타입       │          설명                    │
├──────────────┼──────────────┼─────────────────────────────────┤
│ id           │ BIGINT       │ 첨부파일 번호                    │
│ record_id    │ BIGINT       │ 어떤 기록의 첨부파일인지         │
│ file_name    │ VARCHAR(255) │ 파일명 (예: image.jpg)           │
│ file_path    │ VARCHAR(500) │ 파일 URL                         │
│ file_size    │ BIGINT       │ 파일 크기 (bytes)                │
│ mime_type    │ VARCHAR(100) │ 파일 타입 (예: image/jpeg)       │
└──────────────┴──────────────┴─────────────────────────────────┘
```

### 예시 데이터
```json
{
  "id": 1,
  "recordId": 1,
  "fileName": "screenshot.png",
  "filePath": "https://cdn.example.com/files/screenshot.png",
  "fileSize": 1024000,
  "mimeType": "image/png"
}
```

---

## 🔗 관계

```
records (기록)
    │
    │ 1개 기록은
    │ 여러 개의 첨부파일을 가질 수 있음
    ↓
record_attachments (첨부파일)
```

---

## 📋 히스토리 페이지에서 하는 일

### 1. 기록 목록 조회
```
GET /records
→ records 테이블에서 데이터 가져오기
→ 책(그리모어) 형태로 표시
```

### 2. 검색
```
사용자가 "프로젝트" 검색
→ title이나 content에 "프로젝트" 포함된 기록 찾기
→ 결과 표시
```

### 3. 카테고리 필터
```
사용자가 "학습" 카테고리 선택
→ category가 "학습"인 기록만 표시
```

### 4. 태그 필터
```
사용자가 "개발" 태그 선택
→ tags 배열에 "개발"이 포함된 기록만 표시
```

### 5. 첨부파일 보기
```
기록 상세 보기
→ record_attachments에서 해당 기록의 파일 목록 가져오기
→ 이미지/문서 표시
```

---

## 🎯 간단 요약

**히스토리 페이지는:**
- `records` 테이블에서 기록 읽기 ✅
- `record_attachments` 테이블에서 첨부파일 읽기 ✅
- 그리모어(책) 형태로 예쁘게 표시 ✅

**하지 않는 것:**
- 기록 작성 ❌ (메인 페이지에서 함)
- 기록 수정 ❌ (메인 페이지에서 함)
- 기록 삭제 ❌ (메인 페이지에서 함)
- 파일 업로드 ❌ (메인 페이지에서 함)

---

## 📊 실제 화면 예시

```
┌─────────────────────────────────────┐
│  [검색: 프로젝트] [카테고리: 학습]   │
├─────────────────────────────────────┤
│                                     │
│   ┌──────────┬──────────┐          │
│   │          │          │          │
│   │  기록 1  │  기록 2  │  ← 책    │
│   │          │          │          │
│   └──────────┴──────────┘          │
│                                     │
└─────────────────────────────────────┘

기록 1 내용:
━━━━━━━━━━━━━━━━━━━━━━
제목: 프로젝트 시작
날짜: 2025-12-01
카테고리: 학습
태그: #프로젝트 #개발 #시작
━━━━━━━━━━━━━━━━━━━━━━
오늘부터 새로운 프로젝트를
시작했다...

📎 첨부파일:
  • screenshot.png
  • document.pdf
━━━━━━━━━━━━━━━━━━━━━━
```

---

## 🔍 조회 쿼리 예시

### 전체 기록 조회
```sql
SELECT 
    id,
    title,
    content,
    record_date,
    category,
    tags,
    created_at
FROM records
WHERE user_id = 1
ORDER BY record_date DESC;
```

### 첨부파일 포함 조회
```sql
SELECT 
    r.id,
    r.title,
    r.content,
    r.record_date,
    r.category,
    r.tags,
    a.file_name,
    a.file_path,
    a.file_size
FROM records r
LEFT JOIN record_attachments a ON r.id = a.record_id
WHERE r.user_id = 1
ORDER BY r.record_date DESC;
```

---

## 끝!

히스토리 페이지는 이 2개 테이블만 읽습니다:
1. **records** - 기록 내용
2. **record_attachments** - 첨부파일

간단하죠? 😊
